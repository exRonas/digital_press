@echo off
chcp 65001 > nul
setlocal

:: ============================================================
::  seed_publications.bat
::  Добавляет/обновляет список изданий (publications) в БД.
::  Безопасно: использует updateOrCreate, не трогает выпуски
::  и пользователей.
::
::  Запускать на сервере после развёртывания или если на сервере
::  пропали издания.
:: ============================================================

cd /d "%~dp0..\backend"

echo.
echo ============================================================
echo   СИНХРОНИЗАЦИЯ ИЗДАНИЙ (PUBLICATIONS)
echo ============================================================
echo.

php artisan db:seed --class=PublicationSeeder

if errorlevel 1 (
    echo.
    echo [ОШИБКА] Команда завершилась с ошибкой.
    pause
    exit /b 1
)

echo.
echo Текущий список изданий в БД:
php artisan db:table publications 2>nul

echo.
echo ============================================================
echo  Готово!
echo ============================================================
echo.
pause
